# WAF Fingerprinting

## Cookie values

* Some WAF systems reveal their presence through cookies. They release their own cookie during the HTTP communications.
* As example, Citrix Netscaler uses some different cookies in the HTTP responses like `ns_af` or `citrix_ns_id`. F5 uses cookies starting with `TS`.

## Header values

* Some WAFs rewrite the HTTP headers.
* As example, they modify the `Server` header if the request is malicious or, depending on the malicious request, they just remove it.

## HTTP response code

* Some WAFs modify the HTTP response codes if the request is malicious.
* As example, `mod_security` could send an `406 Not Acceptable` HTTP response.

## HTTP response body

* It is also possible to detect the presence of the WAF plainly in the response body.
* As example, you could find the text *"This text was generated by Mod_Security"* or *"dotDefender blocked your request"*.

## Close connection

* An interesting feature supported by some WAF is `close connection`.
* It is useful in dropping the connection in the case the WAF detects a malicious request.

## Tools

* [WAFW00F][2]
* [Nmap script `http-waf-fingerprint`][3]:
  ```bash
  nmap --script=http-waf-fingerprint www.example.com -p 80
  ```
* [imperva-detect][4]: this utility is focused on the detection of an Imperva WAF.


|Source: [*"Web Application Penetration Testing eXtreme" from INE*][1].|
|:--:|


[1]: https://my.ine.com/INE/courses/630a470a/web-application-penetration-testing-extreme
[2]: https://github.com/EnableSecurity/wafw00f
[3]: https://nmap.org/nsedoc/scripts/http-waf-fingerprint.html
[4]: https://code.google.com/archive/p/imperva-detect/

