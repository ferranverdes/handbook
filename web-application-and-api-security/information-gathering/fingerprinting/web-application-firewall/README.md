# WAF Fingerprinting

## Cookie values

* The presence of some WAF solutions can be identified through cookies set during HTTP communication.
* For instance, cookies such as `ns_af` or `citrix_ns_id` may appear in HTTP responses when Citrix Netscaler is in use, while F5 typically sets cookies beginning with `TS`.

## Header values

* Some WAFs rewrite the HTTP headers.
* In certain cases, the `Server` header is altered or removed in response to malicious HTTP requests.

## HTTP response code

* HTTP status codes may be modified by certain WAFs in response to suspicious or harmful requests.
* As an example, `mod_security` may respond to a malicious request with an HTTP status code of `406 Not Acceptable`.

## HTTP response body

* The presence of a WAF can sometimes be identified directly within the body of the HTTP response.
* Textual indicators like *"This text was generated by Mod_Security"* or *"dotDefender blocked your request"* may appear in the response body, revealing the presence of a WAF.

## Close connection

* Certain WAFs respond to malicious traffic by immediately closing the connection to prevent further interaction.

## Tools

* [WAFW00F][2]
* [Nmap script `http-waf-fingerprint`][3]:

  ```bash
  nmap --script=http-waf-fingerprint www.example.com -p 80
  ```

* [imperva-detect][1]: this utility is focused on the detection of an Imperva WAF.

[1]: https://code.google.com/archive/p/imperva-detect/
[2]: https://github.com/EnableSecurity/wafw00f
[3]: https://nmap.org/nsedoc/scripts/http-waf-fingerprint.html
